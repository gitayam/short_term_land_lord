<div class="room-form card mb-3" data-room-id="{{ room_id or 'new_' + index|string }}">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">
            {% if room_id %}Room #{{ loop.index }}{% else %}New Room{% endif %}
        </h5>
        <div>
            <button type="button" class="btn-close remove-room" aria-label="Remove room"></button>
        </div>
    </div>
    <div class="card-body">
        <input type="hidden" name="room_id" value="{{ room_id or '' }}">
        
        <div class="row">
            <div class="col-md-6">
                <div class="mb-3">
                    <label for="room_name_{{ room_id or 'new_' + index|string }}" class="form-label">Room Name ğŸ“</label>
                    <input type="text" class="form-control" id="room_name_{{ room_id or 'new_' + index|string }}" 
                           name="room_name" value="{{ room_form.name.data or '' }}" required>
                </div>
            </div>
            <div class="col-md-6">
                <div class="mb-3">
                    <label for="room_type_{{ room_id or 'new_' + index|string }}" class="form-label">Room Type ğŸ </label>
                    <select class="form-select room-type-select" id="room_type_{{ room_id or 'new_' + index|string }}" 
                            name="room_type" required>
                        <option value="">Select Room Type</option>
                        <option value="bedroom" {% if room_form.room_type.data == 'bedroom' %}selected{% endif %}>ğŸ›ï¸ Bedroom</option>
                        <option value="living_room" {% if room_form.room_type.data == 'living_room' %}selected{% endif %}>ğŸ›‹ï¸ Living Room</option>
                        <option value="dining_room" {% if room_form.room_type.data == 'dining_room' %}selected{% endif %}>ğŸ½ï¸ Dining Room</option>
                        <option value="kitchen" {% if room_form.room_type.data == 'kitchen' %}selected{% endif %}>ğŸ³ Kitchen</option>
                        <option value="bathroom" {% if room_form.room_type.data == 'bathroom' %}selected{% endif %}>ğŸš¿ Bathroom</option>
                        <option value="office" {% if room_form.room_type.data == 'office' %}selected{% endif %}>ğŸ’¼ Office</option>
                        <option value="other" {% if room_form.room_type.data == 'other' %}selected{% endif %}>ğŸ“¦ Other</option>
                    </select>
                </div>
            </div>
        </div>
        
        <div class="mb-3">
            <label for="room_sqft_{{ room_id or 'new_' + index|string }}" class="form-label">Approximate Square Footage ğŸ“</label>
            <input type="number" class="form-control" id="room_sqft_{{ room_id or 'new_' + index|string }}" 
                   name="room_sqft" value="{{ room_form.square_feet.data or '' }}">
        </div>
        
        <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input has-tv-checkbox" id="has_tv_{{ room_id or 'new_' + index|string }}" 
                   name="has_tv" value="{{ room_id or 'new_' + index|string }}" {% if room_form.has_tv.data %}checked{% endif %}>
            <label class="form-check-label" for="has_tv_{{ room_id or 'new_' + index|string }}">Has TV ğŸ“º</label>
        </div>
        
        <div class="mb-3 tv-details" {% if not room_form.has_tv.data %}style="display: none;"{% endif %}>
            <label for="tv_details_{{ room_id or 'new_' + index|string }}" class="form-label">TV Details (size, type) ğŸ“‹</label>
            <input type="text" class="form-control" id="tv_details_{{ room_id or 'new_' + index|string }}" 
                   name="tv_details" value="{{ room_form.tv_details.data or '' }}">
        </div>
        
        <!-- Add private bathroom option for any room -->
        <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input has-bathroom-checkbox" id="has_bathroom_{{ room_id or 'new_' + index|string }}" 
                   name="has_bathroom" value="{{ room_id or 'new_' + index|string }}" {% if room_form.has_bathroom.data %}checked{% endif %}>
            <label class="form-check-label" for="has_bathroom_{{ room_id or 'new_' + index|string }}">Has Private Bathroom ğŸš¿</label>
        </div>
        
        <!-- Bedroom-specific options -->
        <div class="bedroom-options" {% if room_form.room_type.data != 'bedroom' %}style="display: none;"{% endif %}>
            <div class="mb-3">
                <label for="bed_type_{{ room_id or 'new_' + index|string }}" class="form-label">Bed Type ğŸ›ï¸</label>
                <select class="form-select" id="bed_type_{{ room_id or 'new_' + index|string }}" name="bed_type">
                    <option value="">Select Bed Type</option>
                    <option value="king" {% if room_form.bed_type.data == 'king' %}selected{% endif %}>ğŸ‘‘ King</option>
                    <option value="queen" {% if room_form.bed_type.data == 'queen' %}selected{% endif %}>ğŸ‘¸ Queen</option>
                    <option value="full" {% if room_form.bed_type.data == 'full' %}selected{% endif %}>ğŸ›Œ Full/Double</option>
                    <option value="twin" {% if room_form.bed_type.data == 'twin' %}selected{% endif %}>ğŸ›ï¸ Twin</option>
                    <option value="bunk" {% if room_form.bed_type.data == 'bunk' %}selected{% endif %}>ğŸ—ï¸ Bunk Bed</option>
                    <option value="sofa" {% if room_form.bed_type.data == 'sofa' %}selected{% endif %}>ğŸ›‹ï¸ Sofa Bed</option>
                    <option value="air" {% if room_form.bed_type.data == 'air' %}selected{% endif %}>ğŸ’¨ Air Mattress</option>
                    <option value="crib" {% if room_form.bed_type.data == 'crib' %}selected{% endif %}>ğŸ‘¶ Crib</option>
                    <option value="other" {% if room_form.bed_type.data == 'other' %}selected{% endif %}>ğŸ›ï¸ Other</option>
                </select>
            </div>
        </div>
        
        <!-- Bathroom-specific options -->
        <div class="bathroom-options" {% if room_form.room_type.data != 'bathroom' %}style="display: none;"{% endif %}>
            <div class="mb-3 form-check">
                <input type="checkbox" class="form-check-input" id="has_shower_{{ room_id or 'new_' + index|string }}" 
                       name="has_shower" value="{{ room_id or 'new_' + index|string }}" {% if room_form.has_shower.data %}checked{% endif %}>
                <label class="form-check-label" for="has_shower_{{ room_id or 'new_' + index|string }}">Has Shower ğŸš¿</label>
            </div>
            
            <div class="mb-3 form-check">
                <input type="checkbox" class="form-check-input" id="has_tub_{{ room_id or 'new_' + index|string }}" 
                       name="has_tub" value="{{ room_id or 'new_' + index|string }}" {% if room_form.has_tub.data %}checked{% endif %}>
                <label class="form-check-label" for="has_tub_{{ room_id or 'new_' + index|string }}">Has Bathtub ğŸ›</label>
            </div>
        </div>
        
        <!-- Furniture Section -->
        <div class="furniture-section mt-4">
            <h6>Room Furniture ğŸª‘</h6>
            <div class="furniture-items">
                <!-- Existing furniture will be inserted here in edit mode -->
                {% if room_id and room_form and room_form.furniture %}
                    {% for furniture in room_form.furniture %}
                    <div class="furniture-item card mb-2">
                        <div class="card-body p-3">
                            <div class="row">
                                <div class="col-md-4">
                                    <select class="form-select furniture-type" name="furniture_type_{{ room_id or 'new_' + index|string }}[]">
                                        <option value="">Select Type</option>
                                        <option value="bed" {% if furniture.furniture_type == 'bed' %}selected{% endif %}>ğŸ›ï¸ Bed</option>
                                        <option value="couch" {% if furniture.furniture_type == 'couch' %}selected{% endif %}>ğŸ›‹ï¸ Couch</option>
                                        <option value="chair" {% if furniture.furniture_type == 'chair' %}selected{% endif %}>ğŸª‘ Office Chair</option>
                                        <option value="desk" {% if furniture.furniture_type == 'desk' %}selected{% endif %}>ğŸ–¥ï¸ Desk</option>
                                        <option value="table" {% if furniture.furniture_type == 'table' %}selected{% endif %}>ğŸª“ Table</option>
                                        <option value="dresser" {% if furniture.furniture_type == 'dresser' %}selected{% endif %}>ğŸ—„ï¸ Dresser</option>
                                        <option value="other" {% if furniture.furniture_type == 'other' %}selected{% endif %}>ğŸ“¦ Other</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <input type="text" class="form-control furniture-details" 
                                           name="furniture_details_{{ room_id or 'new_' + index|string }}[]" 
                                           placeholder="Details (size, color, etc.)" 
                                           value="{{ furniture.details or '' }}">
                                </div>
                                <div class="col-md-2">
                                    <input type="number" class="form-control furniture-quantity" 
                                           name="furniture_quantity_{{ room_id or 'new_' + index|string }}[]" 
                                           placeholder="Qty" min="1" value="{{ furniture.quantity or 1 }}">
                                </div>
                                <div class="col-md-2">
                                    <button type="button" class="btn btn-sm btn-danger remove-furniture">Remove</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% endif %}
            </div>
            <button type="button" class="btn btn-sm btn-success add-furniture-btn mt-2" 
                    data-room-id="{{ room_id or 'new_' + index|string }}">
                <i class="fas fa-plus"></i> Add Furniture
            </button>
        </div>
        
        {% if room_id %}
        <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input delete-room-checkbox" id="delete_{{ room_id }}" 
                   name="room_delete" value="{{ room_id }}">
            <label class="form-check-label" for="delete_{{ room_id }}">Delete this room âŒ</label>
        </div>
        {% endif %}
    </div>
</div>

<!-- Template for adding new furniture items (hidden) -->
<template id="furniture-item-template">
    <div class="furniture-item card mb-2">
        <div class="card-body p-3">
            <div class="row">
                <div class="col-md-4">
                    <select class="form-select furniture-type" name="furniture_type_ROOM_ID[]">
                        <option value="">Select Type</option>
                        <option value="bed">ğŸ›ï¸ Bed</option>
                        <option value="couch">ğŸ›‹ï¸ Couch</option>
                        <option value="chair">ğŸª‘ Office Chair</option>
                        <option value="desk">ğŸ–¥ï¸ Desk</option>
                        <option value="table">ğŸª“ Table</option>
                        <option value="dresser">ğŸ—„ï¸ Dresser</option>
                        <option value="other">ğŸ“¦ Other</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <input type="text" class="form-control furniture-details" 
                           name="furniture_details_ROOM_ID[]" 
                           placeholder="Details (size, color, etc.)">
                </div>
                <div class="col-md-2">
                    <input type="number" class="form-control furniture-quantity" 
                           name="furniture_quantity_ROOM_ID[]" 
                           placeholder="Qty" min="1" value="1">
                </div>
                <div class="col-md-2">
                    <button type="button" class="btn btn-sm btn-danger remove-furniture">Remove</button>
                </div>
            </div>
        </div>
    </div>
</template> 